<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0f172a" />
  <title>Quiz Spagnolo â€¢ App Studio</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="wrap topbar__inner">
      <div class="brand">
        <div class="flag" aria-hidden="true">ðŸ‡ªðŸ‡¸</div>
        <div>
          <div class="brand__title">Quiz Spagnolo</div>
          <div class="brand__sub">App scolastica evoluta â€¢ Offline â€¢ Progressi salvati</div>
        </div>
      </div>
      <nav class="nav">
        <button class="chip" id="navHome">Home</button>
        <button class="chip" id="navDashboard">Progressi</button>
        <button class="chip" id="navTeacher">Classe</button>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- HOME -->
    <section class="card" id="home">
      <h1>Verifica da 38 domande (sempre diversa)</h1>
      <p class="muted">Mescola grammatica e lessico (A+B+C + extra). In allenamento hai aiuti, in verifica no.</p>

      <div class="grid">
        <label class="field">
          <span>ModalitÃ </span>
          <select id="mode">
            <option value="train" selected>Allenamento (aiuti + feedback)</option>
            <option value="test">Verifica in classe (no aiuti)</option>
          </select>
        </label>
        <label class="field">
          <span>Nome (per classe, opzionale)</span>
          <input id="studentName" type="text" placeholder="Es. Gabriele" maxlength="24" />
        </label>
        <label class="field">
          <span>Domande</span>
          <input id="count" type="number" min="10" max="60" value="38" />
        </label>
      </div>

      <div class="actions">
        <button class="btn primary" id="startBtn">Inizia</button>
        <button class="btn" id="resumeBtn">Riprendi</button>
        <button class="btn" id="installBtn">Installa (PWA)</button>
      </div>

      <div class="divider"></div>

      <div class="skillsCard">
        <div class="skillsHead">
          <div>
            <h2>Progresso per competenza</h2>
            <p class="muted">Salvato sul dispositivo (Step 8). Ogni quiz aggiorna i grafici.</p>
          </div>
          <div class="pill" id="streakPill">Streak: 0</div>
        </div>
        <div id="skillsBars" class="skillsBars"></div>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section class="card hidden" id="dashboard">
      <div class="row between">
        <h1>Progressi</h1>
        <button class="btn" id="resetProgress">Azzera progressi</button>
      </div>
      <div class="grid2">
        <div class="panel">
          <h3>Competenze</h3>
          <div id="dashSkills" class="skillsBars"></div>
        </div>
        <div class="panel">
          <h3>Verbi</h3>
          <p class="muted">Qui vedi i verbi piÃ¹ sbagliati: il sistema li ripropone piÃ¹ spesso.</p>
          <div id="dashVerbs" class="list"></div>
        </div>
      </div>
      <div class="panel" style="margin-top:12px">
        <div class="row between">
          <h3>Storico verifiche</h3>
          <button class="btn" id="exportProgress">Esporta progressi</button>
        </div>
        <div id="history" class="history"></div>
      </div>
    </section>

    <!-- QUIZ -->
    <section class="card hidden" id="quiz">
      <div class="quizTop">
        <div>
          <div class="kicker" id="qMeta">â€”</div>
          <h2 id="qTitle">Domanda</h2>
        </div>
        <div class="pill" id="scorePill">0/0</div>
      </div>

      <div class="progress">
        <div class="progress__bar" id="progressBar"></div>
      </div>

      <div class="note" id="noteBox">
        <div class="note__title">Formula / Regola</div>
        <div class="note__body" id="noteText">â€”</div>
      </div>

      <div class="qbox">
        <div class="qtext" id="qText">â€”</div>

        <div id="mcq" class="choices"></div>

        <div id="open" class="hidden">
          <label class="field">
            <span class="muted">Risposta</span>
            <input id="openInput" type="text" placeholder="Scrivi quiâ€¦" autocomplete="off" />
          </label>
          <div class="actions">
            <button class="btn primary" id="checkOpen">Verifica</button>
            <button class="btn" id="showHint">Suggerimento</button>
          </div>
          <div class="muted" id="openHint"></div>
        </div>

        <div id="fb" class="feedback"></div>
      </div>

      <div class="actions between">
        <button class="btn" id="prevBtn">Indietro</button>
        <div class="row">
          <button class="btn" id="skipBtn">Salta</button>
          <button class="btn primary" id="nextBtn" disabled>Avanti</button>
        </div>
      </div>

      <div class="divider"></div>
      <div class="indexWrap">
        <div class="row between">
          <div class="muted">Indice domande</div>
          <button class="btn" id="toggleIndex">Mostra/Nascondi</button>
        </div>
        <div id="qIndex" class="qIndex hidden"></div>
      </div>
    </section>

    <!-- RESULT -->
    <section class="card hidden" id="result">
      <div class="row between">
        <h1>Risultato</h1>
        <div class="pill" id="gradePill">â€”</div>
      </div>

      <p id="resultSummary" class="big"></p>

      <div class="grid2">
        <div class="panel">
          <h3>Report competenze</h3>
          <div id="resultSkills" class="skillsBars"></div>
        </div>
        <div class="panel">
          <h3>Codice per Classe</h3>
          <p class="muted">Condividi questo codice al prof (o a te stesso in modalitÃ  Classe) per importare il risultato su un altro dispositivo. Non serve internet o account.</p>
          <textarea id="shareCode" class="code" rows="4" readonly></textarea>
          <div class="actions">
            <button class="btn" id="copyCode">Copia</button>
            <button class="btn" id="exportPDF">Scarica report (HTML)</button>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn" id="reviewBtn">Rivedi errori</button>
        <button class="btn primary" id="backHome">Torna Home</button>
      </div>

      <div id="review" class="review hidden"></div>
    </section>

    <!-- TEACHER -->
    <section class="card hidden" id="teacher">
      <div class="row between">
        <h1>ModalitÃ  Classe</h1>
        <button class="btn" id="clearClass">Svuota elenco</button>
      </div>

      <div class="panel">
        <h3>Importa risultati</h3>
        <p class="muted">Gli studenti ti passano il loro codice (copia/incolla). Puoi incollarne piÃ¹ di uno (uno per riga).</p>
        <textarea id="importBox" class="code" rows="6" placeholder="Incolla qui i codiciâ€¦"></textarea>
        <div class="actions">
          <button class="btn primary" id="importBtn">Importa</button>
          <button class="btn" id="exportClass">Esporta classe</button>
        </div>
      </div>

      <div class="panel" style="margin-top:12px">
        <div class="row between">
          <h3>Classifica</h3>
          <div class="pill" id="classCount">0 risultati</div>
        </div>
        <div id="classList" class="history"></div>
      </div>
    </section>

    <footer class="footer muted">
      <p>Step 8: progressi salvati in locale â€¢ Step 9: modalitÃ  classe senza server (import/export risultati).</p>
    </footer>
  </main>

  <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

  <script src="quiz.js?v=step89" defer></script>
</body>
</html>
